VSV Output files
===============================

to do




Examing VPV's output in the UCSC Genome Browser
~~~~~~~~~~~~~~~~~~~~~~~~~
VPV outputs a series of BED files. Here are the first three lines of a typical file::

	chr11	3814753	3815000	NUP98
	chr11	113929420	113929670	ZBTB16
	chr17	66507972	66508222	PRKAR1A

Each line represents one region for which we would like to generate a probe. The regions are located on the edges of the
restriction fragments chosen by the user with VPV.

One way to validate the results of this analysis are to compare the chosen fragments with the locations of restriction enzyme cutting sites in the genome. Users can generate aBED file for any enzyme and load both BED files as custom tracks to UCSC. Following this,the user can copy URLs from the VPV browser itself and visualize the viewpoints and the fragments they contain together with the information from the BED files.

There are many ways to generate BED files representing restriction sites. We will show one method that uses several Bioconductor libraries (see http://bioconductor.org/ for information on how to install Bioconductor and the required packages). The following code extracts all DpnII sites in the GRCh37 (also known as hg19) build of the human genome. This sites have a zero overhang.::

	library(HiTC)
	library(rtracklayer)
	library(BSgenome.Hsapiens.UCSC.hg19)

	human_chr <- seqlevels(BSgenome.Hsapiens.UCSC.hg19)[1:25]
	resFrag <- getRestrictionFragmentsPerChromosome(resSite="GATC", chromosomes=human_chr, overhangs5=0, 	genomePack="BSgenome.Hsapiens.UCSC.hg19")
	allRF <- do.call("c",resFrag)
	names(allRF) <- unlist(sapply(resFrag, function(x){paste0("HIC_", seqlevels(x), "_", 1:length(x))}))
	export(allRF, format="bed", con="DpnII_resfrag_hg19.bed")

The BED file generated by this script will contain lines that represent restriction fragments located between individual cutting sites::

	$ head DpnII_resfrag_hg19.bed 
	chr1	0	11159	HIC_chr1_1	0	+
	chr1	11159	12410	HIC_chr1_2	0	+
	chr1	12410	12460	HIC_chr1_3	0	+
	chr1	12460	12685	HIC_chr1_4	0	+
	chr1	12685	12828	HIC_chr1_5	0	+
	chr1	12828	13314	HIC_chr1_6	0	+
	chr1	13314	13419	HIC_chr1_7	0	+
	chr1	13419	13565	HIC_chr1_8	0	+
	chr1	13565	13697	HIC_chr1_9	0	+
	chr1	13697	13914	HIC_chr1_10	0	+


We will add the following line to the top of this file in order to display the fragments in blue for better visibility.::

	track name=spacer description="DpnII sites" color=0,0,255,

This can be done with sed as follows.::

	sed  -i '1i track name=spacer description="DpnII sites" color=0,0,255,' DpnII_resfrag_hg19.bed

We remove all mitochondrial fragments, which are not relevant for CHC (one of the entries also seems to cause an import error at the UCSC site).::

	sed -i '/^chrM/d' DpnII_resfrag_hg19.bed

Now go to the My Data|Custom Tracks page at the UCSC Genome Browser, click on the Custom Tracks button, and upload the DpnII BED file. Note that this may take some time (it is about 340 MB). Now you can view the DpnII sites, the chosen fragments,and the highlighted viewpoint regions (use the copy URL to clipboard to obtain a URL for a region of interest).

Note to me--we need a better way to view the individual restriction sites in UCSC. 


 
 
